2025-12-27 12:21:20,300 [INFO] file_cache is only supported with oauth2client<4.0.0
2025-12-27 12:21:20,793 [INFO] Fetched 1 videos from YouTube
2025-12-27 12:22:57,990 [INFO] file_cache is only supported with oauth2client<4.0.0
2025-12-27 12:34:17,875 [INFO] file_cache is only supported with oauth2client<4.0.0
2025-12-27 12:34:18,394 [INFO] Fetched 1 videos from YouTube
2025-12-27 19:04:15,277 [INFO] file_cache is only supported with oauth2client<4.0.0
2025-12-27 19:04:15,815 [INFO] Fetched 1 videos from YouTube
2025-12-27 19:20:29,097 [INFO] file_cache is only supported with oauth2client<4.0.0
2025-12-27 19:20:29,562 [INFO] Fetched 1 videos from YouTube
2025-12-28 09:46:52,114 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 10:31:01,611 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 10:31:01,611 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 19, in ingest_tiktok_user
    for video in user.videos(count=limit):
                 ~~~~~~~~~~~^^^^^^^^^^^^^
TypeError: 'async_generator' object is not iterable
2025-12-28 10:35:02,639 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 10:35:02,639 [WARNING] No valid sessions found, attempting recovery (attempt 1/3)
2025-12-28 10:35:02,639 [WARNING] No valid sessions found, attempting recovery (attempt 2/3)
2025-12-28 10:35:02,639 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 837, in make_request
    i, session = await self._get_valid_session_index(**kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 285, in _get_valid_session_index
    raise Exception(
    ...<2 lines>...
    )
Exception: No valid sessions available. All sessions appear to be dead. Please call create_sessions() again or restart the API.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 20, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<14 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 840, in make_request
    i, session = self._get_session(**kwargs)
                 ~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 679, in _get_session
    raise Exception("No sessions created, please create sessions first")
Exception: No sessions created, please create sessions first
2025-12-28 11:25:19,828 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 11:25:20,127 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 16, in _ingest_tiktok_async
    await api.create_sessions(
    ...<4 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 542, in create_sessions
    raise ValueError("Invalid browser argument passed")
ValueError: Invalid browser argument passed
2025-12-28 11:25:20,164 [WARNING] TikTokApi object is being destroyed but cleanup was not called. Please use 'async with TikTokApi()' or call 'await api.close_sessions()' and 'await api.stop_playwright()' explicitly to avoid resource leaks. Leaked resources: 0 sessions, browser=none, playwright=exists
2025-12-28 11:26:28,890 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 11:26:48,692 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 25, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<14 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 880, in make_request
    raise EmptyResponseException(
    ...<2 lines>...
    )
TikTokApi.exceptions.EmptyResponseException: None -> TikTok returned an empty response. They are detecting you're a bot, try some of these: headless=False, browser='webkit', consider using a proxy
2025-12-28 11:26:48,737 [WARNING] TikTokApi object is being destroyed but cleanup was not called. Please use 'async with TikTokApi()' or call 'await api.close_sessions()' and 'await api.stop_playwright()' explicitly to avoid resource leaks. Leaked resources: 1 sessions, browser=exists, playwright=exists
2025-12-28 11:27:49,446 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 11:28:01,375 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 25, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<14 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 880, in make_request
    raise EmptyResponseException(
    ...<2 lines>...
    )
TikTokApi.exceptions.EmptyResponseException: None -> TikTok returned an empty response. They are detecting you're a bot, try some of these: headless=False, browser='webkit', consider using a proxy
2025-12-28 11:29:08,172 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 11:29:14,951 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 25, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<14 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 880, in make_request
    raise EmptyResponseException(
    ...<2 lines>...
    )
TikTokApi.exceptions.EmptyResponseException: None -> TikTok returned an empty response. They are detecting you're a bot, try some of these: headless=False, browser='webkit', consider using a proxy
2025-12-28 11:30:00,932 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 11:30:16,247 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 25, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<14 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 880, in make_request
    raise EmptyResponseException(
    ...<2 lines>...
    )
TikTokApi.exceptions.EmptyResponseException: None -> TikTok returned an empty response. They are detecting you're a bot, try some of these: headless=False, browser='webkit', consider using a proxy
2025-12-28 11:30:34,615 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 11:30:44,260 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 25, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<14 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 880, in make_request
    raise EmptyResponseException(
    ...<2 lines>...
    )
TikTokApi.exceptions.EmptyResponseException: None -> TikTok returned an empty response. They are detecting you're a bot, try some of these: headless=False, browser='webkit', consider using a proxy
2025-12-28 11:31:15,812 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 11:31:15,812 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 16, in _ingest_tiktok_async
    await api.create_sessions(
          ~~~~~~~~~~~~~~~~~~~^
        num_sessions=1,
        ^^^^^^^^^^^^^^^
    ...<3 lines>...
        proxy = "http://user:pass@ip:port"  # Optional proxy configuration
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: TikTokApi.create_sessions() got an unexpected keyword argument 'proxy'
2025-12-28 11:31:35,924 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 11:31:35,924 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 16, in _ingest_tiktok_async
    await api.create_sessions(
          ~~~~~~~~~~~~~~~~~~~^
        num_sessions=1,
        ^^^^^^^^^^^^^^^
    ...<2 lines>...
        proxy = "http://user:pass@ip:port"  # Optional proxy configuration
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: TikTokApi.create_sessions() got an unexpected keyword argument 'proxy'
2025-12-28 11:39:14,096 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 11:39:24,445 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 34, in _ingest_tiktok_async
    title=video.desc[:100] if video.desc else "",
                              ^^^^^^^^^^
AttributeError: 'Video' object has no attribute 'desc'
2025-12-28 11:41:41,714 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 11:42:02,252 [ERROR] Failed to decode json response: {
    statusCode: -1,
    userInfo: {}
}
2025-12-28 11:42:02,253 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 886, in make_request
    data = json.loads(result)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/json/decoder.py", line 344, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/json/decoder.py", line 360, in raw_decode
    obj, end = self.scan_once(s, idx)
               ~~~~~~~~~~~~~~^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 2 column 5 (char 6)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 25, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<15 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 893, in make_request
    raise InvalidJSONException()
          ~~~~~~~~~~~~~~~~~~~~^^
TypeError: TikTokException.__init__() missing 2 required positional arguments: 'raw_response' and 'message'
2025-12-28 12:02:45,344 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:02:54,055 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 25, in _ingest_tiktok_async
    async for video in user.videos(count=limit):
    ...<16 lines>...
        )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 163, in videos
    await self.info(**kwargs)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/api/user.py", line 77, in info
    resp = await self.parent.make_request(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 880, in make_request
    raise EmptyResponseException(
    ...<2 lines>...
    )
TikTokApi.exceptions.EmptyResponseException: None -> TikTok returned an empty response. They are detecting you're a bot, try some of these: headless=False, browser='webkit', consider using a proxy
2025-12-28 12:20:18,280 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:20:18,280 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 18, in _ingest_tiktok_async
    await api.create_sessions(
          ~~~~~~~~~~~~~~~~~~~^
        num_sessions=1,
        ^^^^^^^^^^^^^^^
    ...<11 lines>...
        }
        ^
    )
    ^
TypeError: TikTokApi.create_sessions() got an unexpected keyword argument 'data_directory'
2025-12-28 12:21:09,416 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:21:10,288 [ERROR] Failed to create session: playwright.async_api._generated.Browser.new_context() got multiple values for keyword argument 'proxy'
2025-12-28 12:21:10,289 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 20, in _ingest_tiktok_async
    await api.create_sessions(
    ...<12 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 341, in __create_session
    context = await self.browser.new_context(proxy=proxy, **context_options)
                    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: playwright.async_api._generated.Browser.new_context() got multiple values for keyword argument 'proxy'
2025-12-28 12:22:01,408 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:22:01,537 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 20, in _ingest_tiktok_async
    await api.create_sessions(
    ...<10 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 521, in create_sessions
    self.browser = await self.playwright.chromium.launch(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 14549, in launch
    await self._impl_obj.launch(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_browser_type.py", line 98, in launch
    await self._channel.send(
        "launch", TimeoutSettings.launch_timeout, params
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: BrowserType.launch: proxy: expected object, got string
2025-12-28 12:22:58,914 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:22:59,908 [ERROR] Failed to create session: Page.goto: net::ERR_INVALID_AUTH_CREDENTIALS at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:22:59,934 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 20, in _ingest_tiktok_async
    await api.create_sessions(
    ...<9 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 355, in __create_session
    _ = await page.goto(url)
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 9041, in goto
    await self._impl_obj.goto(
        url=url, timeout=timeout, waitUntil=wait_until, referer=referer
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_page.py", line 552, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
        "goto", self._navigation_timeout, locals_to_params(locals())
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_INVALID_AUTH_CREDENTIALS at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:23:48,899 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:23:50,036 [ERROR] Failed to create session: Page.goto: net::ERR_HTTP_RESPONSE_CODE_FAILURE at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:23:50,066 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 17, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 355, in __create_session
    _ = await page.goto(url)
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 9041, in goto
    await self._impl_obj.goto(
        url=url, timeout=timeout, waitUntil=wait_until, referer=referer
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_page.py", line 552, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
        "goto", self._navigation_timeout, locals_to_params(locals())
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_HTTP_RESPONSE_CODE_FAILURE at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:24:35,047 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:24:36,393 [ERROR] Failed to create session: Page.goto: net::ERR_HTTP_RESPONSE_CODE_FAILURE at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:24:36,423 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 17, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 355, in __create_session
    _ = await page.goto(url)
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 9041, in goto
    await self._impl_obj.goto(
        url=url, timeout=timeout, waitUntil=wait_until, referer=referer
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_page.py", line 552, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
        "goto", self._navigation_timeout, locals_to_params(locals())
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_HTTP_RESPONSE_CODE_FAILURE at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:26:30,355 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:26:31,105 [ERROR] Failed to create session: Page.goto: net::ERR_PROXY_CONNECTION_FAILED at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:26:31,125 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 17, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 355, in __create_session
    _ = await page.goto(url)
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 9041, in goto
    await self._impl_obj.goto(
        url=url, timeout=timeout, waitUntil=wait_until, referer=referer
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_page.py", line 552, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
        "goto", self._navigation_timeout, locals_to_params(locals())
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_PROXY_CONNECTION_FAILED at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:26:54,774 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:26:55,741 [ERROR] Failed to create session: Page.goto: net::ERR_PROXY_CONNECTION_FAILED at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:26:55,757 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 17, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 355, in __create_session
    _ = await page.goto(url)
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 9041, in goto
    await self._impl_obj.goto(
        url=url, timeout=timeout, waitUntil=wait_until, referer=referer
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_page.py", line 552, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
        "goto", self._navigation_timeout, locals_to_params(locals())
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_PROXY_CONNECTION_FAILED at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 12:27:08,975 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:27:23,508 [INFO] TikTok ingestion complete: 31 videos
2025-12-28 12:32:51,800 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:33:05,390 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:33:05,518 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 22, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 521, in create_sessions
    self.browser = await self.playwright.chromium.launch(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 14549, in launch
    await self._impl_obj.launch(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_browser_type.py", line 98, in launch
    await self._channel.send(
        "launch", TimeoutSettings.launch_timeout, params
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: BrowserType.launch: proxy.server: expected string, got undefined
2025-12-28 12:35:17,497 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 12:35:17,627 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 22, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 521, in create_sessions
    self.browser = await self.playwright.chromium.launch(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 14549, in launch
    await self._impl_obj.launch(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_browser_type.py", line 98, in launch
    await self._channel.send(
        "launch", TimeoutSettings.launch_timeout, params
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: BrowserType.launch: proxy.server: expected string, got undefined
2025-12-28 14:34:33,661 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 14:34:34,013 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 22, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 521, in create_sessions
    self.browser = await self.playwright.chromium.launch(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 14549, in launch
    await self._impl_obj.launch(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_browser_type.py", line 98, in launch
    await self._channel.send(
        "launch", TimeoutSettings.launch_timeout, params
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: BrowserType.launch: proxy.server: expected string, got undefined
2025-12-28 15:08:18,590 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 15:08:35,536 [INFO] TikTok ingestion complete: 32 videos
2025-12-28 15:11:55,858 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 15:11:56,941 [ERROR] Failed to create session: Page.goto: net::ERR_INVALID_AUTH_CREDENTIALS at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 15:11:57,027 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 22, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 355, in __create_session
    _ = await page.goto(url)
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 9041, in goto
    await self._impl_obj.goto(
        url=url, timeout=timeout, waitUntil=wait_until, referer=referer
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_page.py", line 552, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
        "goto", self._navigation_timeout, locals_to_params(locals())
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_INVALID_AUTH_CREDENTIALS at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 15:12:40,045 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 15:12:41,184 [ERROR] Failed to create session: Page.goto: net::ERR_INVALID_AUTH_CREDENTIALS at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 15:12:41,210 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 22, in _ingest_tiktok_async
    await api.create_sessions(
    ...<13 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 592, in create_sessions
    await asyncio.gather(
    ...<17 lines>...
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/TikTokApi/tiktok.py", line 355, in __create_session
    _ = await page.goto(url)
        ^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/async_api/_generated.py", line 9041, in goto
    await self._impl_obj.goto(
        url=url, timeout=timeout, waitUntil=wait_until, referer=referer
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_page.py", line 552, in goto
    return await self._main_frame.goto(**locals_to_params(locals()))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_frame.py", line 153, in goto
    await self._channel.send(
        "goto", self._navigation_timeout, locals_to_params(locals())
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 69, in send
    return await self._connection.wrap_api_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/playwright/_impl/_connection.py", line 559, in wrap_api_call
    raise rewrite_error(error, f"{parsed_st['apiName']}: {error}") from None
playwright._impl._errors.Error: Page.goto: net::ERR_INVALID_AUTH_CREDENTIALS at https://www.tiktok.com/
Call log:
  - navigating to "https://www.tiktok.com/", waiting until "load"

2025-12-28 15:13:45,802 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 15:14:01,828 [INFO] TikTok ingestion complete: 32 videos
2025-12-28 15:36:53,138 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 15:37:07,453 [INFO] TikTok ingestion complete: 0 videos
2025-12-28 16:31:46,001 [INFO] file_cache is only supported with oauth2client<4.0.0
2025-12-28 16:31:46,639 [INFO] Fetched 1 videos from YouTube
2025-12-28 16:32:42,657 [INFO] Starting TikTok ingestion for @somecreator
2025-12-28 16:32:58,222 [INFO] TikTok ingestion complete: 0 videos
2025-12-28 16:34:05,448 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 16:34:22,544 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 62, in _ingest_tiktok_async
    db_videos = [Video(**asdict(v)) for v in videos]
                 ~~~~~^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/state.py", line 596, in _initialize_instance
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/state.py", line 594, in _initialize_instance
    manager.original_init(*mixed[1:], **kwargs)
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/decl_base.py", line 2179, in _declarative_constructor
    raise TypeError(
        "%r is an invalid keyword argument for %s" % (k, cls_.__name__)
    )
TypeError: 'engagement_rate' is an invalid keyword argument for Video
2025-12-28 16:36:07,290 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 16:36:24,209 [ERROR] TikTok ingestion failed
Traceback (most recent call last):
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlite3.OperationalError: no such column: videos.engagement_rate

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/alex.r.yao/cross-platform-video-tracker/ingest/tiktok.py", line 63, in _ingest_tiktok_async
    save_videos_db(db_videos)
    ~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/Users/alex.r.yao/cross-platform-video-tracker/db/session.py", line 12, in save_videos_db
    session.merge(video)
    ~~~~~~~~~~~~~^^^^^^^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3945, in merge
    return self._merge(
           ~~~~~~~~~~~^
        attributes.instance_state(instance),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        _resolve_conflict_map=_resolve_conflict_map,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4023, in _merge
    merged = self.get(
        mapper.class_,
    ...<2 lines>...
        options=options,
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3680, in get
    return self._get_impl(
           ~~~~~~~~~~~~~~^
        entity,
        ^^^^^^^
    ...<7 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 3859, in _get_impl
    return db_load_fn(
        self,
    ...<5 lines>...
        bind_arguments=bind_arguments,
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/loading.py", line 695, in load_on_pk_identity
    session.execute(
    ~~~~~~~~~~~~~~~^
        q,
        ^^
    ...<2 lines>...
        bind_arguments=bind_arguments,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2249, in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<4 lines>...
        conn,
        ^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/orm/context.py", line 306, in orm_execute_statement
    result = conn.execute(
        statement, params or {}, execution_options=execution_options
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/alex.r.yao/.pyenv/versions/3.13.0/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such column: videos.engagement_rate
[SQL: SELECT videos.video_id AS videos_video_id, videos.platform AS videos_platform, videos.creator_id AS videos_creator_id, videos.creator_name AS videos_creator_name, videos.title AS videos_title, videos.published_at AS videos_published_at, videos.views AS videos_views, videos.likes AS videos_likes, videos.comments AS videos_comments, videos.engagement_rate AS videos_engagement_rate 
FROM videos 
WHERE videos.video_id = ?]
[parameters: ('7588953979439041822',)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-12-28 16:37:17,316 [INFO] file_cache is only supported with oauth2client<4.0.0
2025-12-28 16:37:17,796 [INFO] Fetched 1 videos from YouTube
2025-12-28 16:37:24,526 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 16:37:42,164 [INFO] TikTok ingestion complete: 32 videos
2025-12-28 16:57:10,856 [INFO] Starting TikTok ingestion for @mrbeast
2025-12-28 16:57:24,965 [INFO] TikTok ingestion complete: 31 videos
